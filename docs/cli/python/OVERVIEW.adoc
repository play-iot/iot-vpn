= PlayiO VPN overview

== External connection

VPN infrastructure provide private tunnel via Internet connection to our servers.

[NOTE]

Our client will run on beagleboard device, which is running Debian on `armv7`, testing client scripts may need a real device.

== Development script

This is collection of script to bootstrap, manage, setup softether-vpn server.

=== Requirements

* https://www.softether.org/4-docs/1-manual/4._SoftEther_VPN_Client_Manual/4.4_Making_Connection_to_VPN_Server#4.4.3_Connection_Via_HTTP_Proxy_Server[`Connection via HTTPS Proxy`] VPN connection uses `SoftEther VPN protocol` over `HTTPS`, backed by `reverse proxy`, `SSL` is provided by https://letsencrypt.org/[`Letsencrypt`]
* VPN secure connection with https://www.softether.org/4-docs/1-manual/4._SoftEther_VPN_Client_Manual/4.4_Making_Connection_to_VPN_Server#4.4.5_Server-Certificate_Verification[Certificate Verification].
VPN server certificate is generated by us that is link:https://en.wikipedia.org/wiki/Root_certificate#targetText=In%20cryptography%20and%20computer%20security,public%20key%20infrastructure%20(PKI).[`Root CA`]
 ** Use `TLS 1.2`
 ** https://en.wikipedia.org/wiki/Cipher_suite[Cipher suite]: `ECDHE-RSA-AES256-GCM-SHA384`

== Internal communication

* VPN connection type: https://www.softether.org/4-docs/1-manual/1._SoftEther_VPN_Overview/1.4_VPN_Processing_Principle_and_Communication_Method#1.4.7_Remote_Access_VPN[Remote Access VPN]
* Separate customers to `Virtual Hubs`.
* `Virtual Hubs` are isolated to each other.

== Virtual Hub setup

=== IP network

Enable `secureNAT`

* DHCP IP scope (NAT subnet): `10/8 subnet`
* Hub virtual IP (virtual NAT gateway): `10.0.0.1`
* IP configuration push to client:
 ** `Corporate DNS`: IP of Corp's DNS servers
 ** Optional Public Google DNS `8.8.8.8`
 ** Static routes:
+
|===
| Internal resource | Destination network | Net mask | Gateway

| Corporate DNS server
| <DNS Server IP>
| 255.255.255.255
| 10.0.0.1

| Corporate VPN subnet
| 192.168.0.0
| 255.255.255.0
| 10.0.0.1
|===
+
[IMPORTANT]
*And all necessary routes to `internal resource subnets` are defined for a customer separately.

=== User authentication

* Define groups and users for each customer
* Authentication method
 ** Edge device: https://www.softether.org/4-docs/1-manual/2._SoftEther_VPN_Essential_Architecture/2.2_User_Authentication#2.2.6_Signed_Certificate_Authentication[`Signed certificate`] that is signed by our <<External connection,Root CA>>
  *** Each device has one dedicated user
  *** Each device has each `VPN certificate` key
  *** Each device has each `ssh` public/private key
 ** (Optional) Interactive user: `basic password`

=== Virtual Hub security policy

Status: `WIP`

[%interactive]

* [ ] Define hub admin security policy

* [ ] Define security policy and apply to group

* [ ] Define hub extended options
